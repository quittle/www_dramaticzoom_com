var absolutePathToDJuiceUI="/js/";function SuperTable(selector,headerText,populateCells,customize,evenWidth){var tableRoot=document.querySelector(selector);if(tableRoot==null){throw"SuperTable: Invalid selector"}empty(tableRoot);var tableCols=headerText;var populateCellsFunc=populateCells;var customizeFunc=customize;var forceEvenWidth=!!evenWidth;(function(){tableRoot.appendChild(genEl("style",null,null,"			"+selector+"{												display: table;												width: 100%;											}													.superTable-header, .superTable-body-row{									display: table-row;										}													.superTable-header span, .superTable-body-row-item{								display: table-cell;											padding: 5px;												border-right: 1px solid #000;										box-sizing: border-box;											-moz-box-sizing: border-box;										"+(forceEvenWidth?"width: "+100/tableCols.length+"%;":"")+"				}													.superTable-header span{text-align: center;}								.superTable-header span:last-child, .superTable-body-row span:last-child{					border-right: none;										}													.superTable-body-row-item{											border-top: 1px solid #000;										position: relative;										}												"));var header=genEl("div",{"class":"superTable-header"});for(var i=0;i<tableCols.length;i++){header.appendChild(genEl("span",{id:"superTable-header-"+tableCols[i]},null,tableCols[i]))}tableRoot.appendChild(header)})();this.add=function(obj){var row=genEl("div",{"class":"superTable-body-row",key:obj});for(var i=0;i<tableCols.length;i++){var rowItem=genEl("span",{"class":"superTable-body-row-item superTable-row-"+tableCols[i]},null,populateCellsFunc(obj,i));row.appendChild(rowItem);if(customizeFunc){customizeFunc(rowItem,i,false,obj)}}tableRoot.appendChild(row);if(customizeFunc){customizeFunc(row,tableRoot.children.length-2,true,obj)}return row};this.remove=function(obj){var c=tableRoot.children;for(var i=2;i<c.length;i++){if(c[i].key==obj){tableRoot.removeChild(c[i]);return true}}return false};this.reset=function(){var c=tableRoot.children;while(c.length>2){tableRoot.removeChild(c[2])}};var getObjects=function(){var c=tableRoot.children;var objects=[];for(var i=2;i<c.length;i++){objects.push(c[i].key)}return objects};this.sort=function(func){var objects=getObjects();objects.sort(func);while(tableRoot.children.length>2){tableRoot.removeChild(tableRoot.children[2])}for(var i=0;i<objects.length;i++){this.add(objects[i])}};this.min=function(func){var objects=getObjects();objects.sort(func);return objects[0]};this.max=function(func){var objects=getObjects();objects.sort(func);return objects[objects.length-1]};this.find=function(test){var objects=getObjects();var ret=[];for(var i in objects){if(test(objects[i])){ret.push(objects[i])}}return ret}}function Overlay(contents,options){var overlayContents=contents;var body=document.body;var bgColor,popupColor="#fff";try{genEl("div").style.background="rgba(0,0,0,.5)";bgColor="rgba(0,0,0,.2)"}catch(e){bgColor="rgb(15,15,15)"}if(options){if(options.bgColor){bgColor=options.bgColor}if(options.popupColor){popupColor=options.popupColor}}this.show=function(){putClass(overlay,"overlay-show");return this};this.hide=function(){remClass(overlay,"overlay-show");return this};this.destroy=function(){if(overlay&&overlay.parentNode===body){body.removeChild(overlay);delete body;delete overlay;delete style;return this}return null};(function(hide){window.addEventListener("keydown",function(e){if((e||window.event).keyCode==27){hide()}})})(this.hide);var overlay=genEl("div",{"class":"overlay-holder"},{background:bgColor});var readable=function(color,behind){color=Color.toRGBA(color);if(color[3]!=1&&behind!=null){behind=toRGBA(behind)}else{behind=[0,0,0,0]}for(var i=0;i<3;i++){color[i]=color[i]*color[3]+behind[i]*behind[3]}var avg=(color[0]+color[1]+color[2])/3;if(avg<128){return"#fff"}else{return"#000"}};var r=readable(popupColor,bgColor);var rPop=readable(popupColor);var style=genEl("style",null,null,"		html, body{									height: 100%;							}									.overlay-holder{								display: table;								visibility: hidden;							opacity: 0;								width: 100%;								height: 100%;								position: fixed;							left: 0;								top: 0;									z-index: 99999;								text-align: center;							transition: all .2s linear;						-webkit-transition: all .2s linear;					-moz-transition: all .2s linear;					-o-transition: all .2s linear;					}									.overlay-holder.overlay-show{							visibility: visible;							opacity: 1;								transition: all .5s linear;						-webkit-transition: all .5s linear;					-moz-transition: all .5s linear;					-o-transition: all .5s linear;					}									.overlay-popup-holder{								display: table-cell;							vertical-align: middle;						}									.overlay-popup{									display: inline-block;							position: relative;							max-width: 80%;								max-height: 80%;							padding: 20px;								text-align: left;							border-radius: 2px;							box-shadow: 0 0 17px -3px "+rPop+";				}									.overlay-popup-close{								text-decoration: underline;						cursor: pointer;							position: absolute;							top: 0px;								right: 0px;								padding: 5px 13px;							border: 1px solid "+r+";						border-radius: 0 10px;							border-right: 0;							border-top: 0;								font-size: 12px;							color: "+r+";						}								");overlay.appendChild(style);var holder=genEl("div",{"class":"overlay-popup-holder"});var popup=genEl("div",{"class":"overlay-popup"},{background:popupColor},overlayContents);var closeButton=genEl("a",{"class":"overlay-popup-close"},null,"Close");closeButton.addEventListener("click",this.hide);popup.appendChild(closeButton);holder.appendChild(popup);overlay.appendChild(holder);body.appendChild(overlay)}function ColorPicker(selector,listener,color){this.getDOMHolder=function(){return cp};this.setListener=function(f){listener=f};this.setColor=function(c){c=new Color(c);curColor=c;var hsva=c.toHSVA(),h=hsva[0],col=1-Math.abs((h/60)%2-1);if(h<=60){col=[1,col,0]}else{if(h<=120){col=[col,1,0]}else{if(h<=180){col=[0,1,col]}else{if(h<=240){col=[0,col,1]}else{if(h<=300){col=[col,0,1]}else{col=[1,0,col]}}}}}col=new Color(255*col[0],255*col[1],255*col[2]);x=hsva[1];y=1-hsva[2];z=(360-h)*squareSize/360;square.style.background=col.rgb();squareCursor.style.left=x*squareSize-3+"px";squareCursor.style.top=y*squareSize-3+"px";barCursor.style.top=z-3+"px";listener(c,false)};this.getSelectedColor=function(){curColor=getBarColor().combine(255*(1-y),255*(1-y),255*(1-y),Math.sqrt((1-x)*(1-x)+y*y));return curColor};ColorPicker.styling=ColorPicker.styling||document.head.appendChild(genEl("style",{type:"text/css"},{},"			.color-picker{														display: inline-block !important;								position: relative !important;									pointer-events: none !important;								line-height: 0; !important;									}																.color-picker *{													pointer-events: auto !important;							}																.color-picker-square{												margin-right: 10px !important;									width: 256px !important;										height: 256px !important;									}																.color-picker-bar{													display: inline-block !important;								width: 20px !important;											height: 256px !important;									}																.color-picker-square-cursor{										display: inline-block !important;								width: 5px !important;											height: 5px !important;											border: 1px solid #000 !important;								outline: 1px solid #fff !important;								position: absolute !important;									top: -3px;														left: -3px;													}																.color-picker-bar-cursor{											display: inline-block !important;								width: 20px !important;											height: 5px !important;											border: 1px solid #000 !important;								outline: 1px solid #fff !important;								position: absolute !important;									right: -1px !important;										}															"));listener=listener||function(){};var self=this,x=0,y=0,z=0,root=document.querySelector(selector),width=0,height=0,squareSize=0,curColor=new Color(255,255,255),cp=genEl("div",{"class":"color-picker",dJuiceColorPicker:self});root=root?empty(root).appendChild(cp):cp;var square=root.appendChild(genEl("img",{"class":"color-picker-square",src:absolutePathToDJuiceUI+"images/bgGradient.png"},{background:"#f00"}));var squareCursor=root.appendChild(genEl("div",{"class":"color-picker-square-cursor"}));function updateSquare(e,temp){x=getRelativeX(e,square);y=getRelativeY(e,square);squareCursor.style.left=Math.restrict(x-3,0,squareSize-3)+"px";squareCursor.style.top=Math.restrict(y-3,0,squareSize-3)+"px";x/=squareSize;y/=squareSize;listener(self.getSelectedColor(),temp)}square.addEventListener("click",function(e){updateSquare(e,false)});var squareDown=false;map([square,squareCursor],function(o){o.addEventListener("mousedown",function(e){squareDown=true;updateSquare(e,true);e.preventDefault()});o.addEventListener("mouseup",function(e){squareDown=false;e.preventDefault()});o.addEventListener("mousemove",function(e){if(squareDown){updateSquare(e,true)}})});var bar=root.appendChild(genEl("img",{"class":"color-picker-bar",src:absolutePathToDJuiceUI+"images/hueBar.png"}));var barCursor=root.appendChild(genEl("div",{"class":"color-picker-bar-cursor"}));function updateBar(e,temp){z=getRelativeY(e,bar);barCursor.style.top=Math.restrict(getRelativeY(e,bar)-3,-3,squareSize-3)+"px";square.style.background=getBarColor().rgb();listener(self.getSelectedColor(),temp)}bar.addEventListener("click",function(e){updateBar(e,false)});var barDown=false;map([bar,barCursor],function(o){o.addEventListener("mousedown",function(e){barDown=true;updateBar(e,true);e.preventDefault()});o.addEventListener("mouseup",function(e){barDown=false;e.preventDefault()});o.addEventListener("mousemove",function(e){if(barDown){updateBar(e,true)}})});function getBarColor(){var r=0,g=0,b=0,dist=squareSize/6;if(z<dist){r=255;b=255*z/dist}else{if(z<2*dist){b=255;r=255*(2*dist-z)/dist}else{if(z<3*dist){b=255;g=255*(z-2*dist)/dist}else{if(z<4*dist){g=255;b=255*(4*dist-z)/dist}else{if(z<5*dist){g=255;r=255*(z-4*dist)/dist}else{r=255;g=255*(6*dist-z)/dist}}}}}return new Color(r,g,b)}var sizeSquare=256,sizeBar=20,sizeMargin=10;var adjust=function(){var p=cp.parentNode;width=parseInt(style(p,"width",true));height=parseInt(style(p,"height",true));var totalWidth=sizeSquare+sizeBar+sizeMargin;squareSize=sizeSquare/totalWidth*width;cp.style.marginTop=(height-squareSize)/2+"px";square.style.width=squareSize+"px";square.style.marginRight=sizeMargin/totalWidth*width+"px";bar.style.width=barCursor.style.width=sizeBar/totalWidth*width+"px";square.style.height=bar.style.height=squareSize+"px";self.setColor(curColor)};square.addEventListener("load",adjust);cp.addEventListener("resize",adjust);var t=listener;listener=function(){};if(!color){color=new Color(255,255,255)}this.setColor(color);listener=t};